#!/usr/bin/env bash

up() {
	local Count=10#${1:-1}
	while ((Count > 0)); do
		cd .. || return 1
		((Count--))
	done
}

lspkg() { # [NAME] Inspired by TFL/LL
	for File in /var/cache/pacman/pkg/?*; {
		[[ "$File" = *'.sig' ]] ||
			printf '%s\n' "${File#/var/cache/pacman/pkg/}"
	}
}

build() {
	# Check if AUR dir exist or not
	[[ -d $1 ]] || return 1

	# Check if AUR up to date or not
	git --git-dir=${1%/}/.git/ pull || return 1

	# Set build dir
	local BuildDir="${TMPDIR:-/tmp}/build-$SRANDOM"

	# Copy AUR to build dir, exit with status 1 if fails
	cp -r $1 $BuildDir &>/dev/null || return 1

	# Build AUR, exit with status 1 if fails
	cd $BuildDir && makepkg -sir &&
		local Fail=0 || local Fail=1

	# Clean
	{ cd $OLDPWD && rm -rf $BuildDir ;} &>/dev/null
	return $Fail
}

log() {
	git --no-pager log --reverse --pretty=format:'%h: "%s"' "$@"
	printf '\n'
}
